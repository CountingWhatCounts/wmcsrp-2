{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.2", "generated_at": "2025-02-17T17:03:07.111135Z", "invocation_id": "accf9d97-e34d-4b77-bdc6-b79564a2cc05", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:06.876611Z", "completed_at": "2025-02-17T17:03:06.884187Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:06.884658Z", "completed_at": "2025-02-17T17:03:06.884671Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009110689163208008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.stg__ace_levelling_up_for_culture_places", "compiled": true, "compiled_code": "select\n    CAST(local_authority as text) as lad22nm\nfrom\n    \"wmcsrp2\".\"public\".\"raw__ace_levelling_up_for_culture_places\"", "relation_name": "\"wmcsrp2\".\"public_staging\".\"stg__ace_levelling_up_for_culture_places\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:06.886824Z", "completed_at": "2025-02-17T17:03:06.889294Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:06.889726Z", "completed_at": "2025-02-17T17:03:06.889733Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003885984420776367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.stg__ace_npo_funding", "compiled": true, "compiled_code": "select\n    CAST(applicant_name as text) as applicant_name,\n    CAST(type_of_organisation__npo_ipso_transfer_ as text) as type_of_organisation,\n    CAST(national_youth_music_organisation as text) as national_youth_music_organisation,\n    CAST(\"2018-22_average_annual_funding__figure_accurate_at_april_2018_\" as integer) as average_annual_funding_2018_22,\n    CAST(\"2022_23_annual_funding__extension_year_\" as integer) as annual_funding__extension_year_2022_23,\n    CAST(\"2023-26_annual_funding__offered_4_nov_2022_\" as integer) as annual_funding__offered_4_nov_2022_2023_26,\n    CAST(main_discipline as text) as main_discipline,\n    CAST(ace_area as text) as ace_area,\n    CAST(ons_region as text) as ons_region,\n    CAST(constituency as text) as constituency,\n    CAST(local_authority as text) as local_authority\nfrom\n    \"wmcsrp2\".\"public\".\"raw__ace_npo_funding\"", "relation_name": "\"wmcsrp2\".\"public_staging\".\"stg__ace_npo_funding\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:06.891823Z", "completed_at": "2025-02-17T17:03:06.894227Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:06.894677Z", "completed_at": "2025-02-17T17:03:06.894684Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0038721561431884766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.stg__ace_priority_places", "compiled": true, "compiled_code": "select\n    CAST(ladnm as text) as lad22nm,\n    CAST(priority_place as boolean) as priority_place\nfrom\n    \"wmcsrp2\".\"public\".\"raw__ace_priority_places\"", "relation_name": "\"wmcsrp2\".\"public_staging\".\"stg__ace_priority_places\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:06.896805Z", "completed_at": "2025-02-17T17:03:06.899199Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:06.899628Z", "completed_at": "2025-02-17T17:03:06.899635Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003809213638305664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.stg__ace_project_grants_funding", "compiled": true, "compiled_code": "select\n    CAST(recipient as text) as recipient,\n    CAST(activity_name as text) as activity_name,\n    CAST(award_amount as integer) as award_amount,\n    CAST(award_date as date) as award_date,\n    CAST(decision_month as text) as decision_month,\n    CAST(decision_quarter as text) as decision_quarter,\n    CAST(ace_area as text) as ace_area,\n    CAST(local_authority as text) as local_authority,\n    CAST(main_discipline as text) as main_discipline,\n    CAST(strand as text) as strand,\n    CAST(\"time-limited_priority\" as text) as time_limited_priority\nfrom\n    \"wmcsrp2\".\"public\".\"raw__ace_project_grants\"", "relation_name": "\"wmcsrp2\".\"public_staging\".\"stg__ace_project_grants_funding\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:06.901754Z", "completed_at": "2025-02-17T17:03:06.904109Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:06.904547Z", "completed_at": "2025-02-17T17:03:06.904552Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0038499832153320312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.stg__census", "compiled": true, "compiled_code": "select\n    CAST(geography_code as text) as msoa21cd,\n    CAST(n as integer) as n,\n    CAST(measure as text) as measure,\n    CAST(count as integer) as count,\n    CAST(content as text) as content\nfrom\n    \"wmcsrp2\".\"public\".\"raw__census\"", "relation_name": "\"wmcsrp2\".\"public_staging\".\"stg__census\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:06.906642Z", "completed_at": "2025-02-17T17:03:06.909085Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:06.909532Z", "completed_at": "2025-02-17T17:03:06.909538Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0039103031158447266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.stg__cultural_infrastructure", "compiled": true, "compiled_code": "select\n    CAST(area_name as text) as area_name,\n    CAST(postcode as text) as postcode,\n    CAST(service_type as text) as service_type,\n    CAST(name as text) as name,\n    CAST(source as text) as source,\n    CAST(website as text) as website,\n    CAST(category as text) as category,\n    CAST(funding_year as text) as funding_year,\n    CAST(lead_partner_organisation_ as text) as lead_partner_organisation\nfrom\n    \"wmcsrp2\".\"public\".\"raw__cultural_infrastructure\"", "relation_name": "\"wmcsrp2\".\"public_staging\".\"stg__cultural_infrastructure\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:06.911681Z", "completed_at": "2025-02-17T17:03:06.913918Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:06.914384Z", "completed_at": "2025-02-17T17:03:06.914390Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0037696361541748047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.stg__economic", "compiled": true, "compiled_code": "select\n    CAST(local_authority as text) as local_authority,\n    CAST(measure as text) as measure,\n    CAST(value as float) as value,\n    CAST(margin_of_error as float) as margin_of_error\nfrom\n    \"wmcsrp2\".\"public\".\"raw__economic\"", "relation_name": "\"wmcsrp2\".\"public_staging\".\"stg__economic\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:06.916669Z", "completed_at": "2025-02-17T17:03:06.919135Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:06.919580Z", "completed_at": "2025-02-17T17:03:06.919587Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00394439697265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.stg__grant360_funding", "compiled": true, "compiled_code": "select\n    CAST(identifier as text) as identifier,\n    CAST(title as text) as title,\n    CAST(description as text) as description,\n    CAST(currency as text) as currency,\n    CAST(amount_applied_for as integer) as amount_applied_for,\n    CAST(amount_awarded as integer) as amount_awarded,\n    CAST(amount_disbursed as integer) as amount_disbursed,\n    CAST(award_date as date) as award_date,\n    CAST(url as text) as url,\n    CAST(recipient_org_identifier as text) as recipient_org_identifier,\n    CAST(recipient_org_name as text) as recipient_org_name,\n    CAST(recipient_org_charity_number as text) as recipient_org_charity_number,\n    CAST(recipient_org_company_number as text) as recipient_org_company_number,\n    CAST(recipient_org_postal_code as text) as recipient_org_postal_code,\n    CAST(funding_org_identifier as text) as funding_org_identifier,\n    CAST(funding_org_name as text) as funding_org_name,\n    CAST(funding_org_postal_code as text) as funding_org_postal_code,\n    CAST(funding_org__org_type_additional_data as text) as funding_org__org_type_additional_data,\n    CAST(funding_org__canonical_org_id_additional_data as text) as funding_org__canonical_org_id_additional_data,\n    CAST(funding_org__canonical_name_additional_data as text) as funding_org__canonical_name_additional_data,\n    CAST(grant_programme_code as text) as grant_programme_code,\n    CAST(grant_programme_title as text) as grant_programme_title,\n    CAST(grant_type as text) as grant_type,\n    CAST(type_of_recipient as text) as type_of_recipient\nfrom\n    \"wmcsrp2\".\"public\".\"raw__grant360\"", "relation_name": "\"wmcsrp2\".\"public_staging\".\"stg__grant360_funding\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:06.921709Z", "completed_at": "2025-02-17T17:03:06.924153Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:06.924595Z", "completed_at": "2025-02-17T17:03:06.924600Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0039081573486328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.stg__indices_of_deprivation", "compiled": true, "compiled_code": "select\n    CAST(msoa21cd as text) as msoa21cd,\n    CAST(msoa21nm as text) as msoa21nm,\n    CAST(local_authority as text) as local_authority,\n    CAST(imd_score as float) as imd_score,\n    CAST(imd_decile_msoa as integer) as imd_decile_msoa,\n    CAST(imd_quantile_msoa as integer) as imd_quantile_msoa,\n    CAST(msoa_2021_status as text) as msoa_2021_status\nfrom\n    \"wmcsrp2\".\"public\".\"raw__indices_of_deprivation\"", "relation_name": "\"wmcsrp2\".\"public_staging\".\"stg__indices_of_deprivation\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:06.926741Z", "completed_at": "2025-02-17T17:03:06.929099Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:06.929525Z", "completed_at": "2025-02-17T17:03:06.929529Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0038366317749023438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.stg__msoa_mapping", "compiled": true, "compiled_code": "select\n    CAST(msoa11cd as text) as msoa11cd,\n    CAST(msoa11nm as text) as msoa11nm,\n    CAST(chgind as text) as chgind,\n    CAST(msoa21cd as text) as msoa21cd,\n    CAST(msoa21nm as text) as msoa21nm,\n    CAST(lad22cd as text) as lad22cd,\n    CAST(lad22nm as text) as lad22nm,\n    CAST(lad22nmw as text) as lad22nmw,\n    CAST(objectid as integer) as objectid\nfrom\n    \"wmcsrp2\".\"public\".\"raw__msoa_mapping\"", "relation_name": "\"wmcsrp2\".\"public_staging\".\"stg__msoa_mapping\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:06.931681Z", "completed_at": "2025-02-17T17:03:06.935066Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:06.935507Z", "completed_at": "2025-02-17T17:03:06.935511Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004916667938232422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.stg__msoa_population", "compiled": true, "compiled_code": "select\n    CAST(msoa_2021_code as text) as msoa21cd,\n    CAST(total as integer) as population\nfrom\n    \"wmcsrp2\".\"public\".\"raw__msoa_population\"", "relation_name": "\"wmcsrp2\".\"public_staging\".\"stg__msoa_population\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:06.937701Z", "completed_at": "2025-02-17T17:03:06.940053Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:06.940490Z", "completed_at": "2025-02-17T17:03:06.940495Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0039000511169433594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.stg__postcode_mapping", "compiled": true, "compiled_code": "select\n    CAST(REPLACE(pcds, ' ', '') as text) as postcode,\n    CAST(msoa11 as text) as msoa11cd,\n    CAST(msoa21 as text) as msoa21cd\nfrom\n    \"wmcsrp2\".\"public\".\"raw__postcode_mapping\"", "relation_name": "\"wmcsrp2\".\"public_staging\".\"stg__postcode_mapping\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:06.942593Z", "completed_at": "2025-02-17T17:03:06.944992Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:06.945431Z", "completed_at": "2025-02-17T17:03:06.945436Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0038547515869140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.stg__rural_urban_classification", "compiled": true, "compiled_code": "select\n    CAST(\"MSOA11CD\" as text) as msoa11cd,\n    CAST(\"MSOA11NM\" as text) as msoa11nm,\n    CAST(\"RUC11CD\" as text) as ruc11cd,\n    CAST(\"RUC11\" as text) as ruc11\nfrom\n    \"wmcsrp2\".\"public\".\"raw__rural_urban_classification\"", "relation_name": "\"wmcsrp2\".\"public_staging\".\"stg__rural_urban_classification\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:06.947506Z", "completed_at": "2025-02-17T17:03:06.949871Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:06.950328Z", "completed_at": "2025-02-17T17:03:06.950333Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003833293914794922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.stg__wellbeing", "compiled": true, "compiled_code": "select\n    CAST(area_codes as text) as area_codes,\n    CAST(value as float) as value,\n    CAST(margin_of_error as text) as margin_of_error,\n    CAST(date as text) as date,\n    CAST(measure as text) as wellbeing_factor\nfrom\n    \"wmcsrp2\".\"public\".\"raw__wellbeing\"", "relation_name": "\"wmcsrp2\".\"public_staging\".\"stg__wellbeing\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:06.952439Z", "completed_at": "2025-02-17T17:03:06.954929Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:06.955392Z", "completed_at": "2025-02-17T17:03:06.955397Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0040035247802734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.int__local_authority_codes", "compiled": true, "compiled_code": "with\n\ntarget_areas as (\n    select\n        case\n            when lad22nm in (\n                'Birmingham',\n                'Coventry',\n                'Dudley',\n                'Sandwell',\n                'Solihull',\n                'Walsall',\n                'Wolverhampton'\n            ) then 'WMCA Constituent Member'\n            when lad22nm in (\n                'Cannock Chase',\n                'North Warwickshire',\n                'Nuneaton and Bedworth',\n                'Redditch',\n                'Rugby',\n                'Shropshire',\n                'Stratford-on-Avon',\n                'Tamworth',\n                'Telford and Wrekin',\n                'Warwick'\n            ) then 'WMCA Non-Constituent Member'\n            when lad22nm in (\n                'Bromsgrove',\n                'East Staffordshire',\n                'Herefordshire, County of',\n                'Lichfield',\n                'Malvern Hills',\n                'Newcastle-under-Lyme',\n                'South Staffordshire',\n                'Stafford',\n                'Staffordshire Moorlands',\n                'Stoke-on-Trent',\n                'Worcester',\n                'Wychavon',\n                'Wyre Forest'\n            ) then 'West Midlands Non-WMCA'\n            else 'Ignore'\n        end as area,\n        lad22cd,\n        lad22nm\n    from\n        \"wmcsrp2\".\"public_staging\".\"stg__msoa_mapping\"\n),\n\nfilter_areas as (\n    select\n        distinct lad22cd,\n        lad22nm,\n        area\n    from target_areas where area != 'Ignore'\n)\n\nselect * from filter_areas", "relation_name": "\"wmcsrp2\".\"public_warehouse\".\"int__local_authority_codes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:06.959179Z", "completed_at": "2025-02-17T17:03:06.962350Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:06.962786Z", "completed_at": "2025-02-17T17:03:06.962790Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005406618118286133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.int__ace_levelling_up_for_culture_places", "compiled": true, "compiled_code": "with\n\nlevelling_up as (\n    select\n        lad22nm,\n        TRUE as levelling_up_place\n    from \"wmcsrp2\".\"public_staging\".\"stg__ace_levelling_up_for_culture_places\"\n),\n\nlad_codes as (\n    select\n        lad22cd,\n        lad22nm\n    from\n        \"wmcsrp2\".\"public_warehouse\".\"int__local_authority_codes\"\n),\n\ncombined as (\n    select\n        lad22cd,\n        levelling_up_place\n    from levelling_up\n    left join lad_codes\n    on lad_codes.lad22nm = levelling_up.lad22nm\n    where lad22cd is not null\n)\n\nselect * from combined", "relation_name": "\"wmcsrp2\".\"public_warehouse\".\"int__ace_levelling_up_for_culture_places\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:06.964916Z", "completed_at": "2025-02-17T17:03:06.967635Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:06.968092Z", "completed_at": "2025-02-17T17:03:06.968097Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004232883453369141, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.int__ace_npo_funding_aggregated", "compiled": true, "compiled_code": "with npo_funding as (\n    select\n        local_authority,\n        annual_funding__extension_year_2022_23,\n        annual_funding__offered_4_nov_2022_2023_26,\n        average_annual_funding_2018_22\n    from \"wmcsrp2\".\"public_staging\".\"stg__ace_npo_funding\"\n),\n\n\naggregated as (\n    select\n        sum(annual_funding__extension_year_2022_23) as sum_annual_funding_extension_year,\n        sum(annual_funding__offered_4_nov_2022_2023_26) as sum_annual_funding_2023_2026,\n        sum(average_annual_funding_2018_22) as sum_average_annual_funding_2018_2022,\n        local_authority\n    from\n        npo_funding\n    group by\n        local_authority\n),\n\nlocal_authority_codes as (\n    select\n        lad22cd,\n        lad22nm\n    from\n        \"wmcsrp2\".\"public_warehouse\".\"int__local_authority_codes\"\n),\n\n\ncombined as (\n    select\n        distinct lad22cd,\n        lad22nm,\n        case\n            when sum_annual_funding_extension_year is null then 0\n            else sum_annual_funding_extension_year\n        end as sum_annual_funding_extension_year,\n        case\n            when sum_annual_funding_2023_2026 is null then 0\n            else sum_annual_funding_2023_2026\n        end as sum_annual_funding_2023_2026,\n        case\n            when sum_average_annual_funding_2018_2022 is null then 0\n            else sum_average_annual_funding_2018_2022\n        end as sum_average_annual_funding_2018_2022\n    from local_authority_codes\n    left join aggregated on local_authority_codes.lad22nm = aggregated.local_authority\n),\n\n\nfinal as (\n    select\n        lad22cd,\n        lad22nm,\n        CAST(sum_annual_funding_extension_year as INTEGER) as sum_annual_funding_extension_year,\n        CAST(sum_annual_funding_2023_2026 as INTEGER) as sum_annual_funding_2023_2026,\n        CAST(sum_average_annual_funding_2018_2022 as INTEGER) as sum_average_annual_funding_2018_2022\n    from combined\n)\n\n\nselect * from final", "relation_name": "\"wmcsrp2\".\"public_warehouse\".\"int__ace_npo_funding_aggregated\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:06.970177Z", "completed_at": "2025-02-17T17:03:06.972729Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:06.973189Z", "completed_at": "2025-02-17T17:03:06.973194Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003988742828369141, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.int__ace_priority_places", "compiled": true, "compiled_code": "with\n\npriority_places as (\n    select * from \"wmcsrp2\".\"public_staging\".\"stg__ace_priority_places\"\n),\n\nlocal_authority_codes as (\n    select * from \"wmcsrp2\".\"public_warehouse\".\"int__local_authority_codes\"\n),\n\ncombined as (\n    select\n        lad22cd,\n        priority_place\n    from priority_places join local_authority_codes\n    on priority_places.lad22nm = local_authority_codes.lad22nm\n)\n\nselect * from combined", "relation_name": "\"wmcsrp2\".\"public_warehouse\".\"int__ace_priority_places\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:06.975295Z", "completed_at": "2025-02-17T17:03:06.977896Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:06.978376Z", "completed_at": "2025-02-17T17:03:06.978381Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0042362213134765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.int__ace_project_grants_aggregated", "compiled": true, "compiled_code": "with\n\nproject_grants as (\n    select * from \"wmcsrp2\".\"public_staging\".\"stg__ace_project_grants_funding\"\n),\n\n\naggregated as (\n    select\n        sum(award_amount) as sum_award_amount,\n        local_authority\n    from\n        project_grants\n    group by\n        local_authority\n),\n\n\nlocal_authority_codes as (\n    select\n        lad22cd,\n        lad22nm\n    from\n        \"wmcsrp2\".\"public_warehouse\".\"int__local_authority_codes\"\n),\n\n\ncombined as (\n    select\n        distinct lad22cd,\n        lad22nm,\n        case\n            when sum_award_amount is null then 0\n            else sum_award_amount\n        end as sum_award_amount\n    from local_authority_codes\n    left join aggregated on local_authority_codes.lad22nm = aggregated.local_authority\n)\n\n\nselect * from combined", "relation_name": "\"wmcsrp2\".\"public_warehouse\".\"int__ace_project_grants_aggregated\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:06.980654Z", "completed_at": "2025-02-17T17:03:06.983431Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:06.983873Z", "completed_at": "2025-02-17T17:03:06.983878Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004277229309082031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.int__cultural_infrastructure", "compiled": true, "compiled_code": "with\n\nlocal_authority_codes as (\n    select distinct lad22nm, lad22cd\n    from \"wmcsrp2\".\"public_warehouse\".\"int__local_authority_codes\"\n),\n\nservices_msoa as (\n    select\n        area_name as ladnm,\n        msoa21cd,\n        pm.postcode,\n        service_type,\n        name as service_name,\n        source,\n        category\n    from \"wmcsrp2\".\"public_staging\".\"stg__cultural_infrastructure\" as ci\n    left join \"wmcsrp2\".\"public_staging\".\"stg__postcode_mapping\" as pm\n    on ci.postcode = pm.postcode\n),\n\nservices_lad as (\n    select\n        *\n    from services_msoa\n    join local_authority_codes on services_msoa.ladnm = local_authority_codes.lad22nm\n)\n\nselect * from services_lad", "relation_name": "\"wmcsrp2\".\"public_warehouse\".\"int__cultural_infrastructure\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:06.985986Z", "completed_at": "2025-02-17T17:03:06.988757Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:06.989260Z", "completed_at": "2025-02-17T17:03:06.989266Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0042951107025146484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.int__economic", "compiled": true, "compiled_code": "with\n\neconomic_data as (\n    select\n        local_authority,\n        measure,\n        value,\n        margin_of_error\n    from\n        \"wmcsrp2\".\"public_staging\".\"stg__economic\"\n),\n\nlocal_authority_codes as (\n    select\n        lad22cd,\n        lad22nm\n    from\n        \"wmcsrp2\".\"public_warehouse\".\"int__local_authority_codes\"\n)\n\nselect\n    distinct ac.lad22cd,\n    ac.lad22nm,\n    ed.measure,\n    CAST(round(ed.value::numeric, 5) as float) as value,\n    case\n        when margin_of_error < 0.05 then '<5%'\n        when margin_of_error < 0.1 then '5-10%'\n        when margin_of_error < 0.2 then '10-20%'\n    end as margin_of_error\nfrom\n    economic_data as ed\ninner join\n    local_authority_codes as ac\non\n    ed.local_authority = ac.lad22nm", "relation_name": "\"wmcsrp2\".\"public_warehouse\".\"int__economic\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:06.991391Z", "completed_at": "2025-02-17T17:03:06.994035Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:06.994462Z", "completed_at": "2025-02-17T17:03:06.994467Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004046201705932617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.int__msoa_codes", "compiled": true, "compiled_code": "with\n\nall_msoas as (\n    select\n        distinct lad22cd,\n        msoa21cd,\n        msoa21nm\n    from\n        \"wmcsrp2\".\"public_staging\".\"stg__msoa_mapping\"\n),\n\ntarget_msoas as (\n    select * from all_msoas\n    where lad22cd in (select lad22cd from \"wmcsrp2\".\"public_warehouse\".\"int__local_authority_codes\")\n)\n\nselect * from target_msoas", "relation_name": "\"wmcsrp2\".\"public_warehouse\".\"int__msoa_codes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:06.996615Z", "completed_at": "2025-02-17T17:03:06.999382Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:06.999823Z", "completed_at": "2025-02-17T17:03:06.999827Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004301548004150391, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.int__wellbeing", "compiled": true, "compiled_code": "with\n\nwellbeing_data as (\n    select\n        area_codes,\n        wellbeing_factor,\n        value,\n        margin_of_error \n    from\n        \"wmcsrp2\".\"public_staging\".\"stg__wellbeing\"\n),\n\nlocal_authority_codes as (\n    select\n        lad22cd,\n        lad22nm\n    from\n        \"wmcsrp2\".\"public_warehouse\".\"int__local_authority_codes\"\n)\n\nselect\n    distinct ac.lad22cd,\n    ac.lad22nm,\n    wd.wellbeing_factor,\n    CAST(wd.value as float),\n    wd.margin_of_error\nfrom\n    local_authority_codes as ac\nleft join\n    wellbeing_data as wd\non\n    wd.area_codes = ac.lad22cd", "relation_name": "\"wmcsrp2\".\"public_warehouse\".\"int__wellbeing\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:07.001919Z", "completed_at": "2025-02-17T17:03:07.005516Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:07.005981Z", "completed_at": "2025-02-17T17:03:07.005986Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005022764205932617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.west_midlands_local_authority_codes", "compiled": true, "compiled_code": "select\n    lad22cd,\n    lad22nm,\n    area\nfrom \"wmcsrp2\".\"public_warehouse\".\"int__local_authority_codes\"", "relation_name": "\"wmcsrp2\".\"public_marts\".\"West_Midlands_Local_Authority_Codes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:07.008186Z", "completed_at": "2025-02-17T17:03:07.010635Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:07.011112Z", "completed_at": "2025-02-17T17:03:07.011117Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004061222076416016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.int__cultural_infrastructure_lad", "compiled": true, "compiled_code": "with\n\ndistinct_services as (\n    select\n        distinct service_name,\n        lad22cd,\n        service_type\n    from \"wmcsrp2\".\"public_warehouse\".\"int__cultural_infrastructure\"\n)\n\nselect\n    lad22cd,\n    service_type,\n    count(service_name) as service_count\nfrom distinct_services\ngroup by lad22cd, service_type", "relation_name": "\"wmcsrp2\".\"public_warehouse\".\"int__cultural_infrastructure_lad\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:07.013268Z", "completed_at": "2025-02-17T17:03:07.015594Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:07.016048Z", "completed_at": "2025-02-17T17:03:07.016053Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0038604736328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.int__cultural_infrastructure_msoa", "compiled": true, "compiled_code": "with\n\ndistinct_services as (\n    select\n        distinct service_name,\n        msoa21cd,\n        service_type\n    from \"wmcsrp2\".\"public_warehouse\".\"int__cultural_infrastructure\"\n),\n\n\nservices_count as (\n    select\n        msoa21cd,\n        service_type,\n        CAST(count(service_name) as integer) as service_count\n    from distinct_services\n    group by msoa21cd, service_type\n),\n\nremove_null as (\n    select * from services_count\n    where msoa21cd is not null\n)\n\nselect * from remove_null", "relation_name": "\"wmcsrp2\".\"public_warehouse\".\"int__cultural_infrastructure_msoa\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:07.018127Z", "completed_at": "2025-02-17T17:03:07.020746Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:07.021218Z", "completed_at": "2025-02-17T17:03:07.021223Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004107475280761719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.int__census_msoa_base", "compiled": true, "compiled_code": "with\n\nmsoa_codes as (\n    select\n        distinct msoa21cd,\n        msoa21nm\n    from\n        \"wmcsrp2\".\"public_warehouse\".\"int__msoa_codes\"\n),\n\nmsoa_census as (\n    select\n        wac.msoa21cd,\n        wac.msoa21nm,\n        t.content,\n        t.measure,\n        t.count as count,\n        t.n as n\n    from\n        \"wmcsrp2\".\"public_staging\".\"stg__census\" as t\n    inner join\n        msoa_codes as wac\n    on\n        wac.msoa21cd = t.msoa21cd\n)\n\nselect\n    msoa21cd,\n    msoa21nm,\n    content,\n    rtrim(trim(regexp_replace(measure, '[\\s;]*measures: Value$', '')), ';') as measure,\n    count,\n    n\nfrom\n    msoa_census", "relation_name": "\"wmcsrp2\".\"public_warehouse\".\"int__census_msoa_base\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:07.023311Z", "completed_at": "2025-02-17T17:03:07.026227Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:07.026667Z", "completed_at": "2025-02-17T17:03:07.026671Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004381895065307617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.int__grant360", "compiled": true, "compiled_code": "with\n\npostcodes as (\n    select\n        msoa21cd,\n        postcode\n    from\n        \"wmcsrp2\".\"public_staging\".\"stg__postcode_mapping\"\n),\n\n\narea_codes as (\n    select\n        distinct lad22cd,\n        msoa21cd\n    from\n        \"wmcsrp2\".\"public_warehouse\".\"int__msoa_codes\"\n),\n\n\ngrant360 as (\n    select\n        amount_awarded,\n        award_date,\n        recipient_org_name,\n        replace(recipient_org_postal_code, ' ', '') as recipient_org_postal_code,\n        funding_org_name\n    from\n        \"wmcsrp2\".\"public_staging\".\"stg__grant360_funding\"\n),\n\n\ncombined as (\n    select\n        distinct area_codes.msoa21cd,\n        area_codes.lad22cd,\n        grant360.amount_awarded,\n        grant360.award_date,\n        grant360.recipient_org_name,\n        grant360.recipient_org_postal_code,\n        grant360.funding_org_name\n    from grant360\n    join postcodes on grant360.recipient_org_postal_code = postcodes.postcode\n    join area_codes on area_codes.msoa21cd = postcodes.msoa21cd\n)\n\n\nselect * from combined", "relation_name": "\"wmcsrp2\".\"public_warehouse\".\"int__grant360\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:07.028748Z", "completed_at": "2025-02-17T17:03:07.031311Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:07.031753Z", "completed_at": "2025-02-17T17:03:07.031758Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004016876220703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.int__indices_of_deprivation", "compiled": true, "compiled_code": "select\n    msoa21cd,\n    msoa21nm,\n    local_authority,\n    CAST(imd_score as float),\n    imd_decile_msoa,\n    imd_quantile_msoa,\n    msoa_2021_status\nfrom \"wmcsrp2\".\"public_staging\".\"stg__indices_of_deprivation\"\nwhere\n    msoa21cd in (\n        select msoa21cd from \"wmcsrp2\".\"public_warehouse\".\"int__msoa_codes\"\n    )", "relation_name": "\"wmcsrp2\".\"public_warehouse\".\"int__indices_of_deprivation\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:07.033821Z", "completed_at": "2025-02-17T17:03:07.036627Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:07.037103Z", "completed_at": "2025-02-17T17:03:07.037107Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004288911819458008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.int__rural_urban_classification", "compiled": true, "compiled_code": "with\n\nruc as (\n    select * from \"wmcsrp2\".\"public_staging\".\"stg__rural_urban_classification\"\n),\n\nmsoa_mapping as (\n    select * from \"wmcsrp2\".\"public_staging\".\"stg__msoa_mapping\"\n),\n\ncombined as (\n    select\n        msoa21cd,\n        msoa21nm,\n        ruc11cd,\n        ruc11\n    from ruc\n    left join msoa_mapping\n    on ruc.msoa11cd = msoa_mapping.msoa11cd\n),\n\nfiltered as (\n    select * from combined\n    where msoa21cd in (select msoa21cd from \"wmcsrp2\".\"public_warehouse\".\"int__msoa_codes\")\n)\n\nselect * from filtered", "relation_name": "\"wmcsrp2\".\"public_warehouse\".\"int__rural_urban_classification\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:07.039228Z", "completed_at": "2025-02-17T17:03:07.041659Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:07.042129Z", "completed_at": "2025-02-17T17:03:07.042134Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0039043426513671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.ace_levelling_up_for_culture_places", "compiled": true, "compiled_code": "select\n    lad22cd,\n    levelling_up_place\nfrom\n    \"wmcsrp2\".\"public_warehouse\".\"int__ace_levelling_up_for_culture_places\"", "relation_name": "\"wmcsrp2\".\"public_marts\".\"ACE_Levelling_Up_for_Culture_Places\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:07.044248Z", "completed_at": "2025-02-17T17:03:07.046661Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:07.047131Z", "completed_at": "2025-02-17T17:03:07.047135Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003912687301635742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.ace_npo_funding", "compiled": true, "compiled_code": "select * from \"wmcsrp2\".\"public_warehouse\".\"int__ace_npo_funding_aggregated\"", "relation_name": "\"wmcsrp2\".\"public_marts\".\"ACE_NPO_Funding\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:07.049256Z", "completed_at": "2025-02-17T17:03:07.051568Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:07.052023Z", "completed_at": "2025-02-17T17:03:07.052028Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0038967132568359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.ace_priority_places", "compiled": true, "compiled_code": "select\n    lad22cd,\n    priority_place\nfrom\n    \"wmcsrp2\".\"public_warehouse\".\"int__ace_priority_places\"", "relation_name": "\"wmcsrp2\".\"public_marts\".\"ACE_Priority_Places\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:07.054378Z", "completed_at": "2025-02-17T17:03:07.056617Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:07.057074Z", "completed_at": "2025-02-17T17:03:07.057079Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003733396530151367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.ace_project_grants_funding", "compiled": true, "compiled_code": "select\n    lad22cd,\n    CAST(sum_award_amount as integer)\nfrom \"wmcsrp2\".\"public_warehouse\".\"int__ace_project_grants_aggregated\"", "relation_name": "\"wmcsrp2\".\"public_marts\".\"ACE_Project_Grants_Funding\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:07.059176Z", "completed_at": "2025-02-17T17:03:07.061638Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:07.062157Z", "completed_at": "2025-02-17T17:03:07.062161Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004010915756225586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.annual_population_survey_economic_measures", "compiled": true, "compiled_code": "select\n    lad22cd,\n    measure,\n    value,\n    margin_of_error\nfrom \"wmcsrp2\".\"public_warehouse\".\"int__economic\"", "relation_name": "\"wmcsrp2\".\"public_marts\".\"Annual_Population_Survey_Economic_Measures\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:07.064325Z", "completed_at": "2025-02-17T17:03:07.066773Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:07.067237Z", "completed_at": "2025-02-17T17:03:07.067242Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003934144973754883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.annual_population_survey_wellbeing_estimates", "compiled": true, "compiled_code": "select\n    lad22cd,\n    wellbeing_factor,\n    value,\n    margin_of_error\nfrom \"wmcsrp2\".\"public_warehouse\".\"int__wellbeing\"", "relation_name": "\"wmcsrp2\".\"public_marts\".\"Annual_Population_Survey_Wellbeing_Estimates\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:07.069376Z", "completed_at": "2025-02-17T17:03:07.073149Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:07.073589Z", "completed_at": "2025-02-17T17:03:07.073593Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005223512649536133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.west_midlands_msoa_codes", "compiled": true, "compiled_code": "select\n    lad22cd,\n    msoa21cd,\n    msoa21nm\nfrom \"wmcsrp2\".\"public_warehouse\".\"int__msoa_codes\"", "relation_name": "\"wmcsrp2\".\"public_marts\".\"West_Midlands_MSOA_Codes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:07.075686Z", "completed_at": "2025-02-17T17:03:07.078450Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:07.078911Z", "completed_at": "2025-02-17T17:03:07.078915Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004278421401977539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.int__census_msoa_with_population", "compiled": true, "compiled_code": "with msoa_census as (\n    select * from \"wmcsrp2\".\"public_warehouse\".\"int__census_msoa_base\"\n),\n\n\nmsoa_population as (\n    select * from \"wmcsrp2\".\"public_staging\".\"stg__msoa_population\"\n),\n\ncombined as (\n    select\n        msoa_census.msoa21cd,\n        msoa21nm,\n        content,\n        measure,\n        count,\n        n,\n        case\n            when n >= population then n+5\n            else population\n        end as population\n    from msoa_census\n    join msoa_population on msoa_census.msoa21cd = msoa_population.msoa21cd\n)\n\nselect * from combined", "relation_name": "\"wmcsrp2\".\"public_warehouse\".\"int__census_msoa_with_population\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:07.081129Z", "completed_at": "2025-02-17T17:03:07.083488Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:07.083923Z", "completed_at": "2025-02-17T17:03:07.083927Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0037987232208251953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.cultural_infrastructure", "compiled": true, "compiled_code": "select\n    msoa21cd,\n    service_type,\n    service_count\nfrom \"wmcsrp2\".\"public_warehouse\".\"int__cultural_infrastructure_msoa\"", "relation_name": "\"wmcsrp2\".\"public_marts\".\"Cultural_Infrastructure\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:07.086052Z", "completed_at": "2025-02-17T17:03:07.088477Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:07.088931Z", "completed_at": "2025-02-17T17:03:07.088936Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003924369812011719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.grant360_funding_data", "compiled": true, "compiled_code": "select\n    msoa21cd,\n    amount_awarded,\n    award_date,\n    recipient_org_name,\n    recipient_org_postal_code,\n    funding_org_name\nfrom \"wmcsrp2\".\"public_warehouse\".\"int__grant360\"", "relation_name": "\"wmcsrp2\".\"public_marts\".\"Grant360_Funding_Data\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:07.091053Z", "completed_at": "2025-02-17T17:03:07.093472Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:07.093924Z", "completed_at": "2025-02-17T17:03:07.093929Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003908872604370117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.indices_of_deprivation", "compiled": true, "compiled_code": "select\n    msoa21cd,\n    local_authority,\n    imd_score,\n    imd_decile_msoa,\n    imd_quantile_msoa,\n    msoa_2021_status\nfrom \"wmcsrp2\".\"public_warehouse\".\"int__indices_of_deprivation\"", "relation_name": "\"wmcsrp2\".\"public_marts\".\"Indices_of_Deprivation\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:07.096088Z", "completed_at": "2025-02-17T17:03:07.098442Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:07.098891Z", "completed_at": "2025-02-17T17:03:07.098896Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0038743019104003906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.rural_urban_classification", "compiled": true, "compiled_code": "select\n    msoa21cd,\n    ruc11cd,\n    ruc11\nfrom \"wmcsrp2\".\"public_warehouse\".\"int__rural_urban_classification\"", "relation_name": "\"wmcsrp2\".\"public_marts\".\"Rural_Urban_Classification\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:07.101039Z", "completed_at": "2025-02-17T17:03:07.103414Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:07.103848Z", "completed_at": "2025-02-17T17:03:07.103852Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0038633346557617188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.int__census_msoa_with_error", "compiled": true, "compiled_code": "with msoa_census as (\n    select * from \"wmcsrp2\".\"public_warehouse\".\"int__census_msoa_with_population\"\n),\n\nmsoa_with_p as (\n    select\n        msoa21cd,\n        msoa21nm,\n        content as census_question,\n        measure as answer,\n        count as count_of_answer,\n        n as sample_size,\n        population as population_size,\n        count / n as p\n    from\n        msoa_census\n),\n\nmsoa_errors as (\n    select\n        msoa21cd,\n        msoa21nm,\n        census_question,\n        answer,\n        count_of_answer,\n        sample_size,\n        population_size,\n        CAST(p as float),\n        CAST(1.96 * sqrt( (p * (1-p)) / ((population_size - 1) * sample_size / (population_size - sample_size)) ) as float) as margin_of_error\n    from\n        msoa_with_p\n)\n\n\nselect * from msoa_errors", "relation_name": "\"wmcsrp2\".\"public_warehouse\".\"int__census_msoa_with_error\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-17T17:03:07.106236Z", "completed_at": "2025-02-17T17:03:07.108608Z"}, {"name": "execute", "started_at": "2025-02-17T17:03:07.109070Z", "completed_at": "2025-02-17T17:03:07.109075Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003801107406616211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.WMCSRP2_dataset.census", "compiled": true, "compiled_code": "select\n    msoa21cd,\n    census_question,\n    answer,\n    count_of_answer,\n    sample_size,\n    population_size,\n    CAST(p as float),\n    CAST(margin_of_error as float)\nfrom \"wmcsrp2\".\"public_warehouse\".\"int__census_msoa_with_error\"", "relation_name": "\"wmcsrp2\".\"public_marts\".\"Census_2021_Data\"", "batch_results": null}], "elapsed_time": 3.750251293182373, "args": {"partial_parse": true, "require_explicit_package_overrides_for_builtin_materializations": true, "cache_selected_only": false, "source_freshness_run_project_hooks": false, "populate_cache": true, "log_format": "default", "static": false, "defer": false, "profiles_dir": "/home/runner/work/wmcsrp-2/wmcsrp-2", "warn_error_options": {"include": [], "exclude": []}, "log_level": "info", "invocation_command": "dbt docs generate", "skip_nodes_if_on_run_start_fails": false, "require_resource_names_without_spaces": false, "vars": {}, "show_resource_report": false, "version_check": true, "introspect": true, "require_yaml_configuration_for_mf_time_spines": false, "exclude": [], "which": "generate", "select": [], "state_modified_compare_vars": false, "state_modified_compare_more_unrendered_values": false, "send_anonymous_usage_stats": true, "require_batched_execution_for_custom_microbatch_strategy": false, "compile": true, "use_colors_file": true, "favor_state": false, "write_json": true, "log_level_file": "debug", "printer_width": 80, "empty_catalog": false, "require_nested_cumulative_type_params": false, "project_dir": "/home/runner/work/wmcsrp-2/wmcsrp-2", "print": true, "static_parser": true, "strict_mode": false, "log_file_max_bytes": 10485760, "use_colors": true, "log_format_file": "debug", "quiet": false, "macro_debugging": false, "partial_parse_file_diff": true, "log_path": "/home/runner/work/wmcsrp-2/wmcsrp-2/logs", "indirect_selection": "eager"}}